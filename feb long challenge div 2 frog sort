#include<iostream>
#include<bits/stdc++.h>
using namespace std;


int main()
{
    int t;
    cin>>t;
    while(t--)
    {
        int n;
        cin>>n;
        int weight[n],length[n],i;
        
        
        for(i=0;i<n;i++)
        cin>>weight[i];
        
        
        for(i=0;i<n;i++)
        cin>>length[i];
        
        unordered_map<int,pair<int,int> > m;
        
        for(i=0;i<n;i++)
        m[weight[i]]=make_pair(i+1,length[i]);
        
        int count=0;
        
        if(n==2)
        {
            int a=m[2].first;
            int b=m[1].first;
            if(a<=b)
            {
                int x=m[2].second;
                int res=(b-a+1);
                if(res%x==0)
                {
                    count+=(res/x);
                    m[2].first=m[2].first+res;
                }
                else
                {
                    int y=(res/x)+1;
                    m[2].first=m[2].first+(y*x);
                    count+=y;
                }
            }
            cout<<count<<"\n";
        }
        else if(n==3)
        {
            int a=m[3].first;
            int b=m[2].first;
            int c=m[1].first;
            if(b<=c)
            {
                int x=m[2].second;
                int res=(c-b+1);
                if(res%x==0)
                {
                    count+=(res/x);
                    m[2].first=m[2].first+res;
                }
                else
                {
                    int y=(res/x)+1;
                    m[2].first=m[2].first+(y*x);
                    count+=y;
                }
                b=m[2].first;
            }
            if(a<=b)
            {
                int x=m[3].second;
                int res=(b-a+1);
                if(res%x==0)
                {
                    count+=(res/x);
                    m[3].first=m[3].first+res;
                }
                else
                {
                    int y=(res/x)+1;
                    m[3].first=m[3].first+(y*x);
                    count+=y;
                }
                a=m[3].first;
            }
            cout<<count<<"\n";
        }
        else if(n==4)
        {
            int a=m[4].first;
            int b=m[3].first;
            int c=m[2].first;
            int d=m[1].first;
            if(c<=d)
            {
                int x=m[2].second;
                int res=(d-c+1);
                if(res%x==0)
                {
                    count+=(res/x);
                    m[2].first=m[2].first+res;
                }
                else
                {
                    int y=(res/x)+1;
                    m[2].first=m[2].first+(y*x);
                    count+=y;
                }
                c=m[2].first;
            }
            if(b<=c)
            {
                int x=m[3].second;
                int res=(c-b+1);
                if(res%x==0)
                {
                    count+=(res/x);
                    m[3].first=m[3].first+res;
                }
                else
                {
                    int y=(res/x)+1;
                    m[3].first=m[3].first+(y*x);
                    count+=y;
                }
                b=m[3].first;
            }
            if(a<=b)
            {
                int x=m[4].second;
                int res=(b-a+1);
                if(res%x==0)
                {
                    count+=(res/x);
                    m[4].first=m[4].first+res;
                }
                else
                {
                    int y=(res/x)+1;
                    m[4].first=m[4].first+(y*x);
                    count+=y;
                }
                a=m[4].first;
            }
            cout<<count<<"\n";
        }
    }
}
